(this["webpackJsonpninas-bloglist"]=this["webpackJsonpninas-bloglist"]||[]).push([[0],{108:function(e,t,a){e.exports=a(136)},136:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),o=a.n(c),l=a(25),i=a(197),u=a(198),s=a(51),m=a(91),d=a(43),f=a(8),p=a.n(f),g=a(16),b=a(29),E=a.n(b),v=null,h=function(){return{headers:{Authorization:v}}},y={getAll:function(){return E.a.get("/api/blogs").then((function(e){return e.data}))},create:function(){var e=Object(g.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("/api/blogs",t,h());case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(g.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.delete("".concat("/api/blogs","/").concat(t),h());case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(g.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(d.a)({},t,{likes:t.likes+1}),e.next=3,E.a.put("".concat("/api/blogs","/").concat(t.id),a,h());case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){v="bearer ".concat(e)},destroyToken:function(){v=null}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.data;case"LOGOUT":return null;default:return e}},j=function(e,t){var a={message:e,variant:t};return function(e){e({type:"SHOW",data:a}),setTimeout((function(){e({type:"HIDE"})}),5e3)}},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW":return t.data;case"HIDE":return null;default:return e}},w=function(){return E.a.get("/api/users").then((function(e){return e.data}))},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;default:return e}},x={create:function(){var e=Object(g.a)(p.a.mark((function e(t,a){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("".concat("/api/blogs","/").concat(a,"/comments"),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"CREATE_BLOG":return e.concat(t.data);case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data}));case"UPDATE_LIKES":var a=e.find((function(e){return e.id===t.data.id})),n=Object(d.a)({},a,{likes:a.likes+1});return e.map((function(e){return e.id!==n.id?e:n}));case"CREATE_COMMENT":var r=e.find((function(e){return e.id===t.data.blog})),c=Object(d.a)({},r,{comments:r.comments.concat(t.data)});return e.map((function(e){return e.id!==c.id?e:c}));default:return e}},B=Object(s.c)({user:O,users:C,blogs:N,notification:k}),T=Object(s.d)(B,Object(s.a)(m.a)),I=a(21),S=a(33),U=function(e){var t=Object(n.useState)(""),a=Object(I.a)(t,2),r=a[0],c=a[1];return[{type:e,value:r,onChange:function(e){c(e.target.value)}},function(){c("")}]},L={login:function(){var e=Object(g.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("/api/login",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},W=a(206),A=a(3),z=a(165),D=a(167),_=a(70),G=a(69),M=Object(z.a)((function(e){return{success:{backgroundColor:_.a[100],color:e.palette.common.black},error:{backgroundColor:G.a[600],fontWeight:500}}})),q=function(e){var t=e.message,a=e.variant,n=M();return r.a.createElement(D.a,{className:Object(A.a)(n[a]),message:t})},R=Object(l.b)((function(e){return{notification:e.notification}}))((function(e){var t=e.notification;return null===t?null:r.a.createElement(W.a,{open:!0,anchorOrigin:{vertical:"top",horizontal:"center"}},r.a.createElement(q,{message:t.message,variant:t.variant}))})),H=a(169),J=a(207),P=a(59),F=a(199),K=a(173),Q=a(170),V=Object(z.a)((function(e){return{root:{marginTop:e.spacing(9),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{marginTop:e.spacing(2)}}})),X=function(e){var t=e.username,a=e.password,n=e.handleSubmit,c=V();return r.a.createElement(H.a,{maxWidth:"xs"},r.a.createElement("div",{className:c.root},r.a.createElement(J.a,{className:c.avatar},r.a.createElement(Q.a,null)),r.a.createElement(P.a,{component:"h2",variant:"h5"},"Sign In to Bloglist"),r.a.createElement("form",{onSubmit:n,className:c.form,id:"login-form"},r.a.createElement(F.a,Object.assign({},t,{name:"Username",variant:"outlined",margin:"normal",required:!0,fullWidth:!0,autoFocus:!0,label:"Username",autoComplete:"username"})),r.a.createElement(F.a,Object.assign({},a,{name:"Password",variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"Password",autoComplete:"current-password"})),r.a.createElement(K.a,{type:"submit",variant:"contained",color:"primary",size:"large",className:c.submit,fullWidth:!0,"data-cy":"submit"},"Sign In"))))},Y=a(44),Z=a(76),$=a(201),ee=a(196),te=a(174),ae=a(175),ne=a(202),re=Object(z.a)((function(e){return{root:{backgroundColor:e.palette.primary.dark},grow:{flexGrow:1},button:{marginLeft:e.spacing(2)}}})),ce={logoutUser:function(){return function(e){window.localStorage.removeItem("loggedBloglistUser"),y.destroyToken(),e({type:"LOGOUT"})}},setNotification:j},oe=Object(Y.g)(Object(l.b)((function(e){return{user:e.user}}),ce)((function(e){var t=re(),a=e.user;return r.a.createElement(te.a,{position:"sticky",className:t.root},r.a.createElement(ae.a,null,r.a.createElement(P.a,{variant:"h5",component:"h1",color:"inherit"},"Blogs App"),r.a.createElement("div",{className:t.grow}),r.a.createElement("div",null,r.a.createElement(ne.a,{xsDown:!0},"Logged in as ",a.name),r.a.createElement(K.a,{onClick:function(){e.logoutUser(),e.setNotification("".concat(a.name," logged out"),"success")},className:t.button,variant:"outlined",size:"small"},"Logout"))))}))),le=a(200),ie=a(176),ue=function(e){var t=e.buttonLabel,a=e.children,c=Object(n.useState)(!1),o=Object(I.a)(c,2),l=o[0],i=o[1],u={display:l?"none":""},s={display:l?"":"none"},m=function(){i(!l)};return r.a.createElement(le.a,{mb:2},r.a.createElement("div",{style:u},r.a.createElement(K.a,{onClick:m,variant:"outlined",color:"primary",size:"large",fullWidth:!0},t)),r.a.createElement("div",{style:s},a,r.a.createElement(P.a,{component:"div",align:"right"},r.a.createElement(K.a,{onClick:m,endIcon:r.a.createElement(ie.a,null),"data-cy":"cancel"},"Cancel"))))},se=a(177),me=a(178),de=a(179),fe=function(e){var t=e.handleBlogCreation,a=U("text"),n=Object(I.a)(a,2),c=n[0],o=n[1],l=U("text"),i=Object(I.a)(l,2),u=i[0],s=i[1],m=U("text"),d=Object(I.a)(m,2),f=d[0],p=d[1];return r.a.createElement(se.a,null,r.a.createElement(me.a,null,r.a.createElement(P.a,{variant:"h5",align:"center",gutterBottom:!0},"Create New"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({title:c.value,author:u.value,url:f.value}),o(),s(),p()},id:"new-blog-form"},r.a.createElement(le.a,{mt:2,mx:2,mb:3},r.a.createElement(F.a,Object.assign({},c,{name:"Title",label:"Title",fullWidth:!0,required:!0,"data-cy":"title"})),r.a.createElement(F.a,Object.assign({},u,{name:"Author",label:"Author",fullWidth:!0,required:!0,"data-cy":"author"})),r.a.createElement(F.a,Object.assign({},f,{name:"Url",label:"Url",type:"url",fullWidth:!0,required:!0,"data-cy":"url"}))),r.a.createElement(P.a,{component:"div",align:"center"},r.a.createElement(K.a,{type:"submit",variant:"contained",color:"primary",startIcon:r.a.createElement(de.a,null),"data-cy":"create"},"Create")))))},pe=a(180),ge=a(181),be=a(183),Ee=a(172),ve=a(182),he=Object(z.a)((function(e){return{allItems:{"&:hover .MuiAvatar-colorDefault":{backgroundColor:e.palette.primary.main}},selectItems:{"&:hover .MuiAvatar-colorDefault":{backgroundColor:e.palette.secondary.main}},avatar:{backgroundColor:e.palette.grey[300]}}})),ye=function(e){var t=e.blogs,a=e.variant,n=he();return r.a.createElement(Ee.a,null,(t.sort((function(e,t){return t.likes-e.likes})),t.map((function(e){return r.a.createElement(pe.a,{button:!0,key:e.id,to:"/blogs/".concat(e.id),component:S.b,className:Object(A.a)(n[a])},r.a.createElement(ge.a,null,r.a.createElement(J.a,{className:n.avatar},r.a.createElement(ve.a,null))),r.a.createElement(be.a,{primary:e.title}))}))))},Oe=function(e){var t=e.blogs,a=e.handleBlogCreation;return r.a.createElement(H.a,{maxWidth:"sm"},r.a.createElement(le.a,{mt:4,mb:3},r.a.createElement(P.a,{variant:"h3",align:"center",color:"primary",gutterBottom:!0},"Blogs")),r.a.createElement(ue,{buttonLabel:"Add New Blog"},r.a.createElement(fe,{handleBlogCreation:a})),r.a.createElement(ye,{blogs:t,variant:"allItems"}))},je=a(5),ke=a(184),we=a(185),Ce=a(186),xe=a(187),Ne=a(188),Be=a(189),Te=Object(je.a)((function(){return{head:{fontSize:18,fontWeight:400},body:{fontSize:18}}}))(ke.a),Ie=function(e){var t=e.users;return r.a.createElement(H.a,{maxWidth:"sm"},r.a.createElement(le.a,{mt:4,mb:3},r.a.createElement(P.a,{variant:"h3",align:"center",color:"secondary",gutterBottom:!0},"Users")),r.a.createElement(xe.a,{"aria-label":"user table"},r.a.createElement(Ne.a,{color:"primary"},r.a.createElement(we.a,null,r.a.createElement(Te,null,"Name"),r.a.createElement(Te,null,"Blogs"))),r.a.createElement(Be.a,null,t.map((function(e){return r.a.createElement(we.a,{key:e.id},r.a.createElement(Te,null,r.a.createElement(Ce.a,{to:"/users/".concat(e.id),component:S.b,color:"secondary"},e.name)),r.a.createElement(Te,null,e.blogs.length))})))))},Se=a(192),Ue=a(193),Le=a(194),We=a(195),Ae=a(171),ze=a(210),De=a(209),_e=function(e){var t=e.handleCommentCreation,a=U("text"),n=Object(I.a)(a,2),c=n[0],o=n[1];return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({content:c.value}),o()},id:"new-comment-form"},r.a.createElement(Ae.a,{fullWidth:!0,variant:"outlined"},r.a.createElement(ze.a,{htmlFor:"comment"},"Write your comment here..."),r.a.createElement(De.a,Object.assign({},c,{name:"Comment",id:"comment",labelWidth:200,multiline:!0}))),r.a.createElement(le.a,{textAlign:"center",mt:2},r.a.createElement(K.a,{type:"submit",variant:"contained",color:"primary",size:"large"},"Add Comment")))},Ge=a(190),Me=a(191),qe=Object(z.a)((function(e){return{avatar:{color:e.palette.grey[400]}}})),Re=function(e){var t=e.comments,a=qe();return r.a.createElement(Ee.a,null,t.map((function(e){return r.a.createElement(pe.a,{key:e._id},r.a.createElement(Ge.a,null,r.a.createElement(Me.a,{className:a.avatar})),r.a.createElement(be.a,{primary:e.content}))})))},He=function(e){var t=e.comments,a=e.handleCommentCreation;return r.a.createElement(le.a,null,r.a.createElement(P.a,{variant:"h5",align:"center",gutterBottom:!0},"Comments"),r.a.createElement(_e,{handleCommentCreation:a}),r.a.createElement(Re,{comments:t}))},Je=function(){return r.a.createElement(le.a,{mt:6},r.a.createElement(P.a,{variant:"h5",align:"center"},"This page does not exist!"))},Pe=Object(z.a)((function(e){return{card:{marginTop:e.spacing(6),marginBottom:e.spacing(4)},actions:{justifyContent:"space-between",padding:e.spacing(1,2),backgroundColor:e.palette.grey[200]},button:{marginLeft:e.spacing(2),backgroundColor:"#eb928a",color:e.palette.common.white,"&:hover":{backgroundColor:"#e64a19"}}}})),Fe={updateLikes:function(e){return function(){var t=Object(g.a)(p.a.mark((function t(a){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.update(e);case 2:n=t.sent,a({type:"UPDATE_LIKES",data:n});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},createComment:function(e,t){return function(){var a=Object(g.a)(p.a.mark((function a(n){var r;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,x.create(e,t);case 2:r=a.sent,n({type:"CREATE_COMMENT",data:r});case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},setNotification:j},Ke=Object(l.b)(null,Fe)((function(e){var t=Pe(),a=e.blog;return void 0===a?r.a.createElement(Je,null):r.a.createElement(H.a,{maxWidth:"sm"},r.a.createElement(se.a,{className:t.card},r.a.createElement(Se.a,{href:a.url},r.a.createElement(me.a,null,r.a.createElement(P.a,{variant:"h5",component:"h3",align:"center",gutterBottom:!0},a.title),r.a.createElement(P.a,{variant:"subtitle1",component:"h4",color:"textSecondary",align:"center"},"by ",a.author))),r.a.createElement(Ue.a,{className:t.actions},r.a.createElement(P.a,{variant:"body1"},"Added by ",r.a.createElement("strong",null,a.user.name)),r.a.createElement(P.a,{componenet:"div"},a.likes," Likes",r.a.createElement(Le.a,{onClick:function(){return e.updateLikes(Object(d.a)({},a,{user:a.user.id})),void e.setNotification("New like added for '".concat(a.title,"'"),"success")},size:"medium","aria-label":"add like",className:t.button},r.a.createElement(We.a,null))))),r.a.createElement(He,{comments:a.comments,handleCommentCreation:function(t){t.content.length<2?e.setNotification("Comment too short","error"):(e.createComment(t,a.id),e.setNotification("New comment added for '".concat(a.title,"'"),"success"))}}))})),Qe=function(e){var t=e.user;return void 0===t?r.a.createElement(Je,null):r.a.createElement(H.a,{maxWidth:"sm"},r.a.createElement(le.a,{mt:4},r.a.createElement(P.a,{variant:"h4",align:"center",color:"secondary",gutterBottom:!0},t.name)),r.a.createElement(P.a,{variant:"h5",align:"center",gutterBottom:!0},"Added Blogs"),0===t.blogs.length?r.a.createElement(P.a,{variant:"body1",align:"center"},"No blogs as yet."):r.a.createElement(ye,{blogs:t.blogs,variant:"selectItems"}))},Ve={createBlog:function(e,t){return function(){var a=Object(g.a)(p.a.mark((function a(n){var r;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,y.create(e);case 2:r=a.sent,n({type:"CREATE_BLOG",data:Object(d.a)({},r,{user:t})});case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},setNotification:j},Xe=Object(Y.g)(Object(l.b)(null,Ve)((function(e){var t=e.user,a=e.users,n=e.blogs,c=e.history,o=function(a){var r=n.find((function(e){return e.url===a.url}));if(a.title.length<4||a.author.length<2)e.setNotification("Title or author name too short","error");else if(r)e.setNotification("This blog already exists","error");else{var c={name:t.name,username:t.username};e.createBlog(a,c),e.setNotification("New Blog '".concat(a.title,"' by ").concat(a.author," added"),"success")}},l=function(e){c.push(e)};return r.a.createElement("div",null,r.a.createElement(oe,{history:c}),r.a.createElement(Y.b,{path:"/",render:function(e){var t=e.location;return r.a.createElement("div",null,r.a.createElement(Z.a,{square:!0},r.a.createElement($.a,{value:("/"===t.pathname||"/users"===t.pathname)&&t.pathname,onChange:l,indicatorColor:"/"===t.pathname?"primary":"secondary",centered:!0},r.a.createElement(ee.a,{label:"Blogs",component:S.b,to:"/",value:"/"}),r.a.createElement(ee.a,{label:"Users",component:S.b,to:"/users",value:"/users"}))),r.a.createElement(Y.d,null,r.a.createElement(Y.b,{path:"/blogs/:id",render:function(e){var t,a=e.match;return r.a.createElement(Ke,{blog:(t=a.params.id,n.find((function(e){return e.id===t})))})}}),r.a.createElement(Y.b,{path:"/users/:id",render:function(e){var t,n=e.match;return r.a.createElement(Qe,{user:(t=n.params.id,a.find((function(e){return e.id===t})))})}}),r.a.createElement(Y.b,{path:"/users",render:function(){return r.a.createElement(Ie,{users:a})}}),r.a.createElement(Y.a,{exact:!0,from:"/blogs",to:"/"}),r.a.createElement(Y.b,{exact:!0,path:"/",render:function(){return r.a.createElement(Oe,{blogs:n,handleBlogCreation:o})}}),r.a.createElement(Y.b,null,r.a.createElement(Je,null))))}}))}))),Ye={initializeBlogs:function(){return function(){var e=Object(g.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.getAll();case 2:a=e.sent,t({type:"INIT_BLOGS",data:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},initializeUsers:function(){return function(){var e=Object(g.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:a=e.sent,t({type:"INIT_USERS",data:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},initializeUser:function(e){return function(t){y.setToken(e.token),t({type:"LOGIN",data:e})}},setNotification:j,loginUser:function(e){return function(t){window.localStorage.setItem("loggedBloglistUser",JSON.stringify(e)),y.setToken(e.token),t({type:"LOGIN",data:e})}}},Ze=Object(l.b)((function(e){return{user:e.user,users:e.users,blogs:e.blogs}}),Ye)((function(e){var t=U("text"),a=Object(I.a)(t,1)[0],c=U("password"),o=Object(I.a)(c,1)[0],l=e.user,i=e.users,u=e.blogs;Object(n.useEffect)((function(){e.initializeBlogs()}),[]),Object(n.useEffect)((function(){e.initializeUsers()}),[u]),Object(n.useEffect)((function(){var t=window.localStorage.getItem("loggedBloglistUser");if(t){var a=JSON.parse(t);e.initializeUser(a)}}),[]);var s=function(){var t=Object(g.a)(p.a.mark((function t(n){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,L.login({username:a.value,password:o.value});case 4:r=t.sent,e.loginUser(r),e.setNotification("Hi ".concat(r.name,", welcome back!"),"success"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),e.setNotification("Check username and password","error");case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(S.a,null,r.a.createElement("div",null,r.a.createElement(R,null),null===l?r.a.createElement(X,{username:a,password:o,handleSubmit:s}):r.a.createElement(Xe,{user:l,users:i,blogs:u})))})),$e=a(97),et=a(204),tt=Object($e.a)({palette:{primary:{light:"#7de1ee",main:"#46afbc",dark:"#007f8c",contrastText:"#fff"},secondary:{light:"#c68400",main:"#ffb300",dark:"#c68400",contrastText:"#fff"}},overrides:{MuiTab:{root:{minWidth:120}},MuiSnackbarContent:{root:{justifyContent:"center"}}}}),at=tt=Object(et.a)(tt);o.a.render(r.a.createElement(l.a,{store:T},r.a.createElement(i.a,{theme:at},r.a.createElement(u.a,null),r.a.createElement(Ze,null))),document.getElementById("root"))}},[[108,1,2]]]);
//# sourceMappingURL=main.d59578ac.chunk.js.map